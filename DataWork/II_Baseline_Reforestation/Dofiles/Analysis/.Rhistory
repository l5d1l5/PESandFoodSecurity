# Clear memory
rm(list=ls())
# IF YOU'RE RUNNING THIS SCRIPT FOR THE FIRST TIME IN YOUR COMPUTER, ACTIVATE THIS
# SWITCH TO INSTALL THE NECESSARY PACKAGES
PACKAGES <- 1
# PART 0: Load packages ------------------------------------------------------------
# Before running this you need to have installed at least Rtools 3.3 from here https://cran.r-project.org/bin/windows/Rtools/
# List packages used
packages  <- c("dplyr",
"plyr",
"sp",
"rgdal",
"rgeos",
"leaflet",
"ggplot2",
"geosphere",
"raster")
# If you selected the option to install packages, install them
if (PACKAGES = 1 )  {
install.packages(packages,
dependencies = TRUE)
}
# If the package installation fails, install separately leaflet by running 'install.packages("shiny", type="binary")' directly in the console
# Load all packages -- this is equivalent to using library(package) for each
# package listed before
sapply(packages, library, character.only = TRUE)
library(RColorBrewer)
#display.brewer.all()
# PART 1: File paths ---------------------------------------------------------------
# List users: To find out what is your userame, type Sys.getenv("USERNAME")
System <- Sys.getenv(x = NULL, unset = "")
User <- System["USER"]
if (User == "jonasguthoff") {
projectFolder <- "/Users/jonasguthoff/Dropbox/Burkina Faso IEs/Burkina Faso Forestry/DataWork/II_Baseline_Reforestation/DataSets"
}
# Data folders
geodata    <- file.path(projectFolder,"geodata")
install.packages(packages, dependencies = TRUE)
# PART 1: File paths ---------------------------------------------------------------
# List users: To find out what is your userame, type Sys.getenv("USERNAME")
System <- Sys.getenv(x = NULL, unset = "")
User <- System["USER"]
if (User == "jonasguthoff") {
projectFolder <- "/Users/jonasguthoff/Dropbox/Burkina Faso IEs/Burkina Faso Forestry/DataWork/II_Baseline_Reforestation/DataSets"
}
# Data folders
geodata    <- file.path(projectFolder,"geodata")
# Set different folders for each administrative level, we have shape files for the following:
# 13 Regions
# 45 Provinces
# 351 Departments/Provinces
RegionFolder      <- file.path(geodata,"regions")
ProvincesFolder   <- file.path(geodata,"provinces")
CommunesFolder    <- file.path(geodata,"communes")
burkina_region_shp <- readOGR(dsn=RegionFolder, layer = "bfa_admbnda_adm1_igb_20180814", stringsAsFactors = F)
plot(burkina_region_shp)
summary(burkina_region_shp@data)
# Load the PROVINCES
burkina_PROV_shp <- readOGR(dsn=ProvincesFolder, layer = "bfa_admbnda_adm2_igb_20180814", stringsAsFactors = F)
plot(burkina_PROV_shp)
summary(burkina_PROV_shp@data)
plot(burkina_COMMUNES_shp)
# Load the COMMUNES
burkina_COMMUNES_shp <- readOGR(dsn=CommunesFolder, layer = "bfa_admbnda_adm3_igb_20180814", stringsAsFactors = F)
plot(burkina_COMMUNES_shp)
summary(burkina_COMMUNES_shp@data)
*read.csv()
?read.csv
project_communes <- read.table("geodata/project_area.csv")
project_communes <- read.table(geodata,"project_area.csv")
BF_project_communes <- read.csv(file.path(geodata,"project_area.csv"),header = T)
BF_project_communes
BF_project_area <- read.csv(file.path(geodata,"project_area.csv"),header = T)
?unique
?unique
BF_project_area$Communes
BF_project_communes <- unique(BF_project_area$Communes, incomparables = FALSE)
BF_project_communes
plot(burkina_PROV_shp)
plot(burkina_COMMUNES_shp)
burkina_COMMUNES_shp
View(burkina_COMMUNES_shp)
class(burkina_COMMUNES_shp)
BF_project_communes
View(burkina_COMMUNES_shp)
burkina_COMMUNES_shp@data[["ADM2_FR"]]
subset_COMMUNES <- subset(burkina_COMMUNES_shp, BF_project_communes$ADM2_FR)
subset_COMMUNES <- subset(burkina_COMMUNES_shp, burkina_COMMUNES_shp$ADM2_FR == BF_project_communes)
subset_COMMUNES <- subset(burkina_COMMUNES_shp, burkina_COMMUNES_shp$ADM2_FR == BF_project_communes, )
subset_COMMUNES <- data[burkina_COMMUNES_shp$ADM2_FR %in% BF_project_communes, ]
subset_COMMUNES <- data[burkina_COMMUNES_shp$ADM2_FR %in% BF_project_communes ]
class(burkina_COMMUNES_shp)
burkina_COMMUNES_DF <- as.data.frame(burkina_COMMUNES_DF)
burkina_COMMUNES_DF <- as.data.frame(burkina_COMMUNES_shp)
burkina_COMMUNES_DF
class(burkina_COMMUNES_DF)
subset_COMMUNES <- data[burkina_COMMUNES_DF$ADM2_FR %in% BF_project_communes, ]
subset_COMMUNES <- subset(burkina_COMMUNES_DF$ADM2_FR, subject %in% BF_project_communes)
subset_COMMUNES <- subset(burkina_COMMUNES_DF, ADM2_FR %in% BF_project_communes)
subset_COMMUNES
BF_project_communes
View(burkina_COMMUNES_DF)
burkina_COMMUNES_DF$ADM2_FR
subset_COMMUNES <- subset(burkina_COMMUNES_DF, ADM2_FR %in% BF_project_communes)
subset_COMMUNES
View(subset_COMMUNES)
burkina_COMMUNES_shp$ADM2_FR
burkina_COMMUNES_subs <- subset(burkina_COMMUNES_shp, ADM2_FR %in% BF_project_communes)
burkina_COMMUNES_subs
View(burkina_COMMUNES_subs)
burkina_COMMUNES_subs <- burkina_COMMUNES_shp[burkina_COMMUNES_shp$ADM2_FR %in% BF_project_communes,]
burkina_COMMUNES_subs
View(burkina_COMMUNES_subs)
burkina_COMMUNES_subs <- burkina_COMMUNES_shp[burkina_COMMUNES_shp$ADM2_FR %in% BF_project_communes]
burkina_COMMUNES_subs
View(burkina_COMMUNES_subs)
burkina_COMMUNES_subs@data
burkina_COMMUNES_subs@proj4string@projargs
burkina_COMMUNES_shp$ADM2_FR
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
burkina_COMMUNES_shp_df
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$ADM2_FR %in% BF_project_communes]
shp_df
shp_df <- broom::tidy(burkina_region_shp, region = "ADM1_FR")
lapply(shp_df, class)
subset_regions  <- subset(shp_df,id == "Boucle du Mouhoun"|id == "Centre-Ouest" | id == "Sud-Ouest" | id == "Est")
shp_df
subset_regions  <- subset(shp_df,id == "Boucle du Mouhoun"|id == "Centre-Ouest" | id == "Sud-Ouest" | id == "Est")
burkina_region_shp
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
burkina_COMMUNES_shp_df
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$id %in% BF_project_communes, ]
burkina_COMMUNES_subs
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id))
plot(map)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon() +
theme_void()
plot(map)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon() +
theme_void() +
geom_polygon(data = burkina_COMMUNES_subs, fill ="darkgreen") +
geom_text(data = cnames, aes(x = long, y = lat, label = id), size = 4) +
geom_path(color = "white") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon() +
theme_void() +
geom_polygon(data = burkina_COMMUNES_subs, fill ="darkgreen") +
geom_path(color = "white") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_COMMUNES_shp, fill ="white") +
theme_void() +
geom_polygon(data = burkina_COMMUNES_subs, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
burkina_COMMUNES_subs
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_COMMUNES_subs, fill ="white") +
theme_void() +
geom_polygon(data = burkina_COMMUNES_subs, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
plot(burkina_COMMUNES_subs)
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$id %in% BF_project_communes ]
burkina_COMMUNES_subs <- subset(burkina_COMMUNES_shp_df,id %in% BF_project_communes)
burkina_COMMUNES_subs
map <- ggplot(data = burkina_COMMUNES_shp_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_COMMUNES_shp_df, fill ="white") +
theme_void() +
geom_polygon(data = burkina_COMMUNES_subs, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
plot(burkina_COMMUNES_shp)
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
burkina_COMMUNES_subs <- subset(burkina_COMMUNES_shp_df,id %in% BF_project_communes)
plot(burkina_COMMUNES_shp_df)
map <- ggplot() +
geom_polygon(data = burkina_region_shp, aes(x = long, y = lat, group = group), colour = "black", fill = NA)
# map without the raster
map + theme_void()
shp_df <- broom::tidy(burkina_region_shp, region = "ADM1_FR")
burkina_region_shp
?tidy
??broom::tidy
?broom::tidy
View(burkina_region_shp)
shp_df <- broom::tidy(burkina_region_shp, region = "ADM1_FR")
lapply(shp_df, class)
subset_regions  <- subset(shp_df,id == "Boucle du Mouhoun"|id == "Centre-Ouest" | id == "Sud-Ouest" | id == "Est")
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
burkina_COMMUNES_shp_df
BF_project_communes
burkina_COMMUNES_subs$id
burkina_COMMUNES_subs <- subset(burkina_COMMUNES_shp_df,id %in% BF_project_communes)
burkina_COMMUNES_subs
class(burkina_COMMUNES_subs)
View(subset_regions)
class(subset_regions)
View(burkina_COMMUNES_subs)
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$id %in% BF_project_communes,]
class(burkina_COMMUNES_subs)
View(burkina_COMMUNES_subs)
BF_project_communes
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$id %in% BF_project_communes,]
View(burkina_COMMUNES_subs)
plot(burkina_COMMUNES_shp)
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
BF_project_communes
BF_project_area
BF_project_communes
View(burkina_COMMUNES_shp)
burkina_COMMUNES_shp@data[["ADM2_FR"]]
BF_project_area <- read.csv(file.path(geodata,"project_area.csv"),header = T)
BF_project_communes <- unique(BF_project_area$Communes, incomparables = FALSE)
plot(burkina_COMMUNES_shp)
View(burkina_COMMUNES_shp)
burkina_COMMUNES_shp_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM2_FR")
lapply(burkina_COMMUNES_shp_df, class)
burkina_COMMUNES_subs <- burkina_COMMUNES_shp_df[burkina_COMMUNES_shp_df$id %in% BF_project_communes,]
burkina_COMMUNES_subs
View(burkina_COMMUNES_subs)
burkina_COMMUNES_subs
class(burkina_COMMUNES_shp_df)
class(BF_project_communes)
BF_project_communes
class(burkina_COMMUNES_shp_df)
BF_project_communes
class(burkina_COMMUNES_shp_df)
burkina_COMMUNES_df <- burkina_COMMUNES_shp@data
burkina_COMMUNES_df
View(burkina_COMMUNES_df)
burkina_COMMUNES_df_subset <- burkina_COMMUNES_df[burkina_COMMUNES_df$ADM2_FR %in% BF_project_communes,]
burkina_COMMUNES_df_subset
View(burkina_COMMUNES_df_subset)
burkina_COMMUNES_df_subset <- burkina_COMMUNES_df[burkina_COMMUNES_df$ADM2_FR %in% BF_project_communes]
View(burkina_COMMUNES_df_subset)
burkina_COMMUNES_df_subset <- subset(burkina_COMMUNES_df,ADM2_FR %in% BF_project_communes)
View(burkina_COMMUNES_df_subset)
BF_project_communes
View(BF_project_communes)
BF_project_communes
burkina_COMMUNES_df$ADM2_FR == "Bakata"
burkina_COMMUNES_df$ADM3_FR == "Bakata"
burkina_COMMUNES_df_subset <- subset(burkina_COMMUNES_df, ADM3_FR %in% BF_project_communes)
View(burkina_COMMUNES_df_subset)
burkina_COMMUNES_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM3_FR")
lapply(burkina_COMMUNES_df, class)
subset_regions  <- subset(burkina_COMMUNES_df, id %in% BF_project_communes)
subset_regions
View(burkina_COMMUNES_df_subset)
projectCommunes  <- subset(burkina_COMMUNES_df, id %in% BF_project_communes)
map <- ggplot(data = burkina_COMMUNES_shp_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = projectCommunes, fill ="white") +
theme_void() +
geom_polygon(data = projectCommunes, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
plot(burkina_COMMUNES_shp)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon(data = projectCommunes, fill ="white") +
theme_void() +
geom_polygon(data = projectCommunes, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
BF_project_communes
projectCommunes
View(projectCommunes)
summary(projectCommunes)
distinct(projectCommunes$id)
unique(projectCommunes$id)
BF_project_communes
unique(BF_project_area$Communes)
BF_project_communes <- unique(BF_project_area$Communes, incomparables = FALSE)
dim(BF_project_communes)
View(BF_project_communes)
# subset the data
projectCommunes  <- subset(burkina_COMMUNES_df, id %in% BF_project_communes)
unique(projectCommunes$id)
BF_project_area <- read.csv(file.path(geodata,"project_communes_cleaned.csv"),header = T)
BF_project_communes <- unique(BF_project_area$Communes, incomparables = FALSE)
View(BF_project_communes)
BF_project_area <- read.csv(file.path(geodata,"project_communes_cleaned.csv"),header = T)
BF_project_area
BF_project_area <- read.csv(file.path(geodata,"project_communes_cleaned.csv"),header = T)
BF_project_area
unique(BF_project_area$communes)
BF_project_communes <- unique(BF_project_area$communes, incomparables = FALSE)
View(BF_project_communes)
BF_project_area
unique(BF_project_area$communes)
unique(BF_project_area$commune)
BF_project_communes <- unique(BF_project_area$commune, incomparables = FALSE)
View(BF_project_communes)
plot(burkina_COMMUNES_shp)
View(burkina_COMMUNES_shp)
burkina_COMMUNES_df <- broom::tidy(burkina_COMMUNES_shp, region = "ADM3_FR")
lapply(burkina_COMMUNES_df, class)
# subset the data
projectCommunes  <- subset(burkina_COMMUNES_df, id %in% BF_project_communes)
View(projectCommunes)
projectCommunes  <- subset(burkina_COMMUNES_df, id %in% BF_project_communes)
View(projectCommunes)
unique(projectCommunes$id)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon(data = projectCommunes, fill ="white") +
theme_void() +
geom_polygon(data = projectCommunes, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Régions du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_COMMUNES_shp, aes(x = long, y = lat, group = id)) +
geom_polygon(data = projectCommunes, fill ="white") +
theme_void() +
geom_polygon(data = projectCommunes, fill ="palegreen4") +
geom_path(color = "black") +
labs(title="Burkina Faso - Communes du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
BF_project_area <- read.csv(file.path(geodata,"project_communes_cleaned.csv"),header = T)
BF_project_area
BF_project_area
BF_project_provinces <- unique(BF_project_area$province, incomparables = FALSE)
BF_project_provinces
plot(burkina_PROV_shp)
burkina_PROV_df <- broom::tidy(burkina_PROV_shp, region = "ADM2_FR")
lapply(burkina_PROV_df, class)
# subset the spatial data
burkina_PROV_df <- broom::tidy(burkina_PROV_shp, region = "ADM2_FR")
lapply(burkina_PROV_df, class)
projectProvinces  <- subset(burkina_PROV_df, id %in% BF_project_provinces)
projectProvinces
cnames <- aggregate(cbind(long, lat) ~ id, data=projectProvinces, FUN=mean)
cnames
projectProvinces  <- subset(burkina_PROV_df, id %in% BF_project_provinces)
map <- ggplot(data = burkina_PROV_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_PROV_df, fill ="white") +
theme_void() +
geom_polygon(data = projectProvinces, fill ="palegreen4") +
geom_text(data = cnames, aes(x = long, y = lat, label = id), size = 4) +
geom_path(color = "black") +
labs(title="Burkina Faso - Provinces du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_PROV_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_PROV_df, fill ="white") +
theme_void() +
geom_polygon(data = projectProvinces, fill ="palegreen4") +
geom_text(data = cnames, aes(x = long, y = lat, label = id), size = 3) +
geom_path(color = "black") +
labs(title="Burkina Faso - Provinces du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_PROV_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_PROV_df, fill ="white") +
theme_void() +
geom_polygon(data = projectProvinces, fill ="palegreen4") +
geom_text(data = cnames, aes(x = long, y = lat, label = id), size = 5) +
geom_path(color = "black") +
labs(title="Burkina Faso - Provinces du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
map <- ggplot(data = burkina_PROV_df, aes(x = long, y = lat, group = id)) +
geom_polygon(data = burkina_PROV_df, fill ="white") +
theme_void() +
geom_polygon(data = projectProvinces, fill ="palegreen4") +
geom_text(data = cnames, aes(x = long, y = lat, label = id), size = 4) +
geom_path(color = "black") +
labs(title="Burkina Faso - Provinces du projet") +
theme(plot.title = element_text(color="black", size=15, face="bold.italic"))
plot(map)
